# Backup & Restore (черновик)

## Цели
- Гарантировать восстановление данных (артефакты, результаты оценок, рубрики)
- Минимизировать RPO и RTO

## Объекты резервного копирования
| Объект | Механизм | Частота | Retention |
|--------|----------|---------|-----------|
| PostgreSQL (метаданные) | pg_dump / snapshots | каждые 6ч | 30 дней |
| S3 артефакты | Версионность + object locking | немедленно | 90 дней |
| Конфигурации (рубрики) | Git репозиторий | commit | бессрочно |

## Процедура Backup
1. Инициировать dump БД (консистентный snapshot)
2. Проверить успешный размер/хэш
3. Залить в объектное хранилище с префиксом `backup/yyyy-mm-dd/`
4. Логировать trace_id и метаданные

## Процедура Restore (тестовая)
1. Развернуть пустую временную БД
2. Восстановить последний dump
3. Сравнить контрольные выборки (counts / checksums)
4. Очистить временные ресурсы

## Метрики
- Успешность ночного восстановления тестового restore
- Среднее время восстановления

## Риски
- Неполное покрытие новых таблиц
- Непроверенные большие бинарные артефакты
