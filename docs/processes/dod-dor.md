# Definition of Ready (DoR) & Definition of Done (DoD)

Единый источник критериев готовности задачи к разработке и критериев завершённости инкремента / Pull Request. Документ предназначен
для всех доменных команд (FE, BE, ML, DevOps, Core).

## Принципы

1. Один источник правды — перечень критериев не дублируется в других документах (Scrum intro, PR template).
2. Эволюция через PR + явное версионирование (см. блок Versioning ниже).
3. Проверяемость — формулировки бинарны (да/нет) или имеют измеримый показатель.
4. Осознанное исключение — критерий можно временно снять только явно отметив в PR ("waived").

## Структура

| Область | Символ | Применимо к |
|---------|--------|-------------|
| Backlog Readiness | R | Issue / User Story до взятия в Sprint |
| Implementation Done | D | Инкремент / PR |
| Quality Gates | Q | Автоматические проверки CI |
| Release Readiness | L | Кандидат к релизу |

## Definition of Ready (DoR)

Минимальный набор, чтобы взять элемент в Sprint.

| Код | Критерий | Детали / Guidance |
|-----|----------|-------------------|
| R1 | Чёткое бизнес-ценностное описание | Почему важно, кому польза |
| R2 | Acceptance Criteria в формате GWT/список | Пример: Given/When/Then / список наблюдаемых условий |
| R3 | Определён измеримый успех | Метрика (latency, % coverage, NPS proxy и т.д.) |
| R4 | Идентифицированы зависимости | Внешние сервисы, блокеры, фичи |
| R5 | Оценка (Story Points / T-Shirt) | Зафиксировано в issue |
| R6 | Нет критических блокеров | Блокеры явно устранены или явно зафиксированы с планом |
| R7 | Non-Functional требования понятны | Performance, Security, Privacy, Regulatory |
| R8 | Данные/fixtures доступны | Тестовые данные описаны или план получения |
| R9 | UX/макеты приложены (если релевантно) | Ссылка на Figma / wireframes |
| R10 | Определён владелец (assignee/candidate) | Ответственный понятен |

### Дополнительные DoR для ML (опционально)

| Код | Критерий | Детали |
|-----|----------|--------|
| R-ML1 | Определён baseline | Модель/метрика для сравнения |
| R-ML2 | Данные очищены/валидация спланирована | План data quality checks |
| R-ML3 | Целевые метрики сформулированы | e.g. F1 ≥ 0.82, latency ≤ 200ms |

## Definition of Done (DoD)

Критерии завершения реализации и готовности к merge.

| Код | Критерий | Детали / Guidance |
|-----|----------|-------------------|
| D1 | Все acceptance criteria выполнены | Сопоставить с issue ссылкой |
| D2 | Code Review пройден (минимум 2 апрува*) | Или 1 апрув при low-risk тривиальных правках |
| D3 | CI pipeline зелёный | Все обязательные джобы прошли |
| D4 | Линтеры/форматтеры чисты | Нет новых ворнингов уровня error |
| D5 | Unit/Component тесты добавлены | Покрывают новую функциональность |
| D6 | Изменены или подтверждены метрики наблюдаемости | Логи/трейсы/дэшборды учли новую часть |
| D7 | Security проверки пройдены | SAST/Dependency scan без критики (или зафиксирован WA) |
| D8 | Docs обновлены | README/архитектура/ADR/комментарии кода |
| D9 | Feature flags (если есть) задокументированы | Состояние включения/выключения |
| D10 | Миграции БД применимы и обратимы | Тест отката проведён (если критично) |
| D11 | Performance не деградировал | Сравнительный замер / профилирование |
| D12 | Нет TODO-комментариев без issue | TODO сопровождается ссылкой или удалён |
| D13 | Ветка синхронизирована с main | Нет конфликтов, актуальные зависимости |
| D14 | Ручное тестирование критичных путей | Скриншоты/шаги в PR (если UI) |

### Дополнительные DoD для ML

| Код | Критерий | Детали |
|-----|----------|--------|
| D-ML1 | Метрики против baseline улучшены или объяснены | Таблица сравнения |
| D-ML2 | Задокументирован датасет и версия | Dataset card / hash snapshot |
| D-ML3 | Зафиксирован seed и конфиг | Реплицируемость обучения |
| D-ML4 | Модель артефакт сохранён и проверен | Размер, формат, checksum |
| D-ML5 | Drift monitoring hooks обновлены | Алгоритм/алертинг настроен |

## Quality Gates (авто)

| Код | Gate | Инструмент / Подход |
|-----|------|---------------------|
| Q1 | Unit/Component Tests | Jest / PyTest / etc. |
| Q2 | Lint | ESLint / Ruff / flake8 |
| Q3 | Security SCA | Dependabot / osv-scanner |
| Q4 | SAST | Semgrep / CodeQL |
| Q5 | Coverage Threshold | Jest/pytest-cov report >= target |
| Q6 | Build Artifact Integrity | Hash compare / SBOM |
| Q7 | Vulnerability Gate | Максимальный уровень severity допуска |

## Release Readiness (L)

| Код | Критерий | Детали |
|-----|----------|--------|
| L1 | CHANGELOG обновлён | Секции Added/Changed/Fixed/Removed |
| L2 | Версия повышена корректно (semver) | Учитывает тип изменений |
| L3 | Миграции выполнены на staging | Прогон успешен |
| L4 | Rollback план описан | Что делаем при отказе |
| L5 | Мониторинг/алерты расширены | Новые метрики/алерты активны |
| L6 | Лицензии зависимостей соответствуют политике | Скрипт/отчёт прикреплён |

## Использование в процессе

- Scrum intro и PR template содержат ссылки на этот документ вместо дублирования.
- В PR остаётся чеклист, но элементы мапятся на коды (D*, Q*, L*).
- Исключения: добавляем секцию Waived Criteria в описании PR.

## Versioning

| Поле | Описание |
|------|----------|
| version | Семантический номер (Major.Minor.Patch) изменений критериев |
| effective_from | Дата вступления в силу |
| change_summary | Краткое описание добавленных/удалённых пунктов |

Механизм: при изменении критериев обновляем таблицу ниже и создаём PR с пометкой `[CORE] DoD/DoR update`.

| version | effective_from | change_summary |
|---------|----------------|----------------|
| 1.0.0 | TBD | Initial baseline |

## Связанные документы

- `scrum-intro.md` (будет обновлён на ссылку сюда)
- `../architecture/grading-module.md`
- `../processes/labels.md`
- `../ai-models/model-strategy.md`

## ToDo / Дальнейшие улучшения

- Добавить автоматический чекер соответствия (GitHub Action) по кодам D*/Q*/L*.
- Внедрить шаблон Waived Criteria в PR.
- Инструмент генерации diff между версиями DoD/DoR.
